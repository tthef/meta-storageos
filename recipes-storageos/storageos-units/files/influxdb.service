[Unit]
Description=StorageOS Metrics (influxdb)
After=docker.service
After=flanneld.service

[Service]
Restart=on-failure
ExecStartPre=-/usr/bin/docker kill influxdb
ExecStartPre=-/usr/bin/docker rm influxdb
ExecStartPre=/usr/bin/docker pull influxdb
ExecStart=/bin/sh -c "docker run --name influxdb -p 8083:8083 -p 8086:8086 --expose 8090 --expose 8099 -e PRE_CREATE_DB="collectd" tutum/influxdb"
ExecStop=/usr/bin/docker stop influxdb
